[tasks.setup]
description = "Create symlinks for dotfiles to home directory"
run = '''
#!/bin/bash
set -e

IGNORE_FILES=".git README.md mise.toml bin"
BASE_PATH="{{config_root}}"

for file in "$BASE_PATH"/{.*,*}; do
  filename=$(basename "$file")

  # Skip ignored files
  [[ " $IGNORE_FILES " =~ " $filename " ]] && continue
  [[ "$filename" == "." || "$filename" == ".." ]] && continue

  dest="$HOME/$filename"
  ln -sfn "$file" "$dest"
  echo "Linked: $filename -> $dest"
done
'''

[tasks.deno-scripts]
description = "Install deno scripts"
depends = ["install:deno"]
run = '''
#!/bin/bash
set -e
deno install --global --allow-run -n git-modified_files https://deno.land/x/git_modified_files@0.1.4/main.ts
'''

[tasks."install:deno"]
description = "Install deno via mise"
run = "mise install deno"
